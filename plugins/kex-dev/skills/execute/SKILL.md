---
name: execute
version: 0.1.0
description: 按 plan 逐步实现，TDD 驱动，批量执行 + checkpoint。当用户说"执行计划"、"开始实现"、"按plan做"时触发。
---

# 执行实施计划

加载 plan，批判性审查，批量执行任务，每批完成后报告等待反馈。

**核心原则：** 批量执行 + checkpoint 审查。遇阻即停，不猜。

**开始时宣布：** "我正在使用 execute 技能来实施计划。"

## Step 1：加载与审查 Plan

1. 读取 `CLAUDE.md` 了解项目技术栈和规范
2. 扫描 `docs/plans/` 找到"待执行"或"进行中"的 plan（无则提示先执行 `/plan`）
3. 批判性审查 plan — 发现问题先与用户讨论再开始
4. 从上次未完成的步骤继续（支持跨 session 恢复）
5. 创建 task 追踪每个步骤

## Step 2：批量执行（默认每批 3 个 task）

对每个 task：
1. 标记为 in_progress
2. 严格按 plan 中的步骤执行
3. 运行 plan 指定的验证命令
4. 标记为 completed
5. 更新 plan 文件 checkbox 和状态行

## TDD 铁律

```
没有失败的测试，就不写生产代码
```

Red-Green-Refactor 循环：
1. **RED** — 写一个失败的测试，运行确认失败
2. **GREEN** — 写最少代码让测试通过，运行确认通过
3. **REFACTOR** — 保持绿灯，清理代码

| 借口 | 现实 |
|------|------|
| "太简单不用测" | 简单代码也会坏，测试只要 30 秒 |
| "先写完再补测试" | 后补的测试立即通过，证明不了什么 |
| "手动测过了" | 手动测试无记录、不可重复 |
| "删掉 X 小时的代码太浪费" | 沉没成本谬误，保留未验证代码才是浪费 |

**写了代码再补测试？删掉代码，从测试重新开始。**

## Step 3：批次报告

每批完成后：
- 展示已实现的内容
- 展示验证输出
- 说："等待反馈。"
- 根据反馈调整后执行下一批

## Step 4：模块完成

所有 task 完成后：
- 将 plan 状态改为"已完成"
- 移入 `docs/plans/archive/`，注明归档时间
- 记录经验教训到 `CLAUDE.md`
- 提示用户执行 `/review`

## 何时停下来

**立即停止执行：**
- 遇到阻塞（缺依赖、测试反复失败、指令不清）
- Plan 有关键缺口无法继续
- 验证反复失败

**不要猜测，直接问用户。**
