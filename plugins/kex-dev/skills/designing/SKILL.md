---
name: designing
version: 0.1.0
description: 脑暴 + 设计：探索需求、讨论方案、产出设计文档到 docs/design/。当用户说"设计方案"、"脑暴"、"讨论设计"时触发。
---

# 脑暴与设计

帮助将想法转化为完整的设计方案，通过自然的协作对话推进。

**开始时宣布：** "我正在使用 design 技能来探索和设计方案。"

<HARD-GATE>
在设计方案被用户批准之前，不得编写任何代码、创建任何文件（设计文档除外）、或调用任何实现类技能。无论项目多简单，都必须经过设计流程。
</HARD-GATE>

## 反模式："这个太简单了，不需要设计"

每个功能都要走设计流程。简单功能的设计可以只有几句话，但必须展示并获得批准。"简单"项目中未经审视的假设造成的浪费最多。

## 流程检查清单

为以下每个步骤创建 task，按顺序完成：

1. **探索项目上下文** — 读取 CLAUDE.md、`docs/design/overview.md`（顶层索引）、`docs/plans/overview.md`、近期 commits
2. **逐一提问澄清需求** — 每次只问一个问题，理解目的/约束/成功标准
3. **提出 2-3 种方案** — 附带权衡分析和推荐
4. **逐节展示设计** — 每节确认后再继续，按复杂度调整篇幅
5. **编写设计文档** — 保存到 `docs/design/<name>.md` 并提交
6. **过渡到实施** — 提示用户执行 `/kex-dev:plan`

## 详细流程

### 理解想法
- 先检查项目当前状态（文件、文档、近期 commits）
- 每次只问一个问题来细化想法
- 优先使用多选题，开放式问题也可以
- 聚焦于：目的、约束、成功标准

### 探索方案
- 提出 2-3 种不同方案，附带权衡分析
- 以推荐方案开头，解释推荐理由
- YAGNI：激进砍掉不必要的功能

### 展示设计
- 按节展示，每节根据复杂度调整篇幅（简单几句话，复杂 200-300 字）
- 每节展示后询问用户是否认可
- 覆盖：架构、组件、数据流、错误处理、测试策略
- 随时准备回退修改

## 设计文档规范

设计文档采用层级结构（overview + 子文档），便于 AI 按需加载：

```
docs/design/
├── overview.md          ← 顶层索引（定位、架构图、技术栈）
├── roadmap.md           ← Roadmap
├── shared/              ← CLI 与 SaaS 共享概念
├── cli/                 ← CLI 域设计
│   └── overview.md      ← CLI 索引
└── saas/                ← SaaS 域设计
    └── overview.md      ← SaaS 索引
```

- 新增设计内容根据所属域保存到对应子目录
- 跨域共享概念放 `shared/`
- 每个子目录的 `overview.md` 作为该域的索引
- 文件名不加日期，变更记录写在文件内部
- 提交到 git

**放置示例：**

| 设计内容 | 保存位置 | 理由 |
|----------|----------|------|
| 纯前端的新功能 | `frontend/feature-x.md` | 只涉及前端域 |
| 纯后端的新功能 | `backend/feature-y.md` | 只涉及后端域 |
| 前后端共用的数据格式 | `shared/data-format.md` | 两端都要理解 |
| 修改现有认证流程 | 更新 `backend/auth.md` | 已有文档，追加变更记录 |

文档头部模板：
```markdown
# <模块名> 设计方案

> 状态：草案
>
> 变更记录：
> - YYYY-MM-DD：初稿，涵盖 ...
```

## 核心原则

- **每次一问** — 不要同时抛多个问题
- **多选优先** — 比开放式问题更容易回答
- **YAGNI** — 激进移除不必要的功能
- **探索替代方案** — 定方案前至少提出 2-3 种选择
- **渐进验证** — 逐节展示，逐节确认
- **灵活调整** — 发现问题随时回退修改
