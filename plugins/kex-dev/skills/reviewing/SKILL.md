---
name: reviewing
version: 0.1.0
description: 当用户说"代码审查"、"review代码"、"检查实现"时触发。多维度审查实现代码，可独立迭代。
---

代码审查助手。先读取 `CLAUDE.md` 了解项目技术栈和规范。

## 前置准备

1. 通过 git diff 确定本次审查的代码变更范围
2. 读取 `docs/design/overview.md`（顶层索引）定位相关子文档，按需深入阅读作为参照
3. 读取 `docs/plans/overview.md` 定位对应的 plan，如需详情再读具体 plan 文件

## 审查维度

### 1. 设计一致性
- 实现是否与设计文档一致
- 接口和数据结构是否匹配设计意图
- 有无偏离设计的未讨论变更

### 2. 代码质量
- 逻辑错误、边界条件遗漏
- 不必要的复杂度，过度工程
- 命名清晰度，代码可读性
- 是否遵循项目技术栈的惯用写法和最佳实践

常见语言审查要点示例：
- **Rust**：优先用 `Result`/`Option` 而非 `unwrap()`；借用优于克隆；用枚举表达状态机；错误类型实现 `thiserror`；避免不必要的 `clone()`/`Arc`
- **TypeScript**：严格类型而非 `any`；用联合类型代替枚举字符串；`readonly` 保护不可变数据；async 错误要有 catch 路径

### 3. 类型设计
- 类型是否表达了正确的不变量
- 封装是否合理，内部状态是否暴露过多
- 类型构造是否强制合法状态

示例：用 `TerminalId(String)` newtype 而非裸 `String`，构造时验证格式；用 `enum Status { Running, Stopped }` 而非 `bool is_running`

### 4. 安全检查
- 无硬编码密钥或敏感信息
- 系统边界处的输入验证
- 公开仓库同步目录中无敏感内容泄露

### 5. 测试覆盖
- 主要逻辑路径是否有测试
- 边界条件和错误路径是否覆盖

## 产出格式

按严重程度分级列出发现：
- **🔴 必须修复**：逻辑错误、安全问题
- **🟡 建议修复**：代码质量、设计偏差
- **🟢 可选优化**：风格、命名、简化

如无问题，确认审查通过。
完成后提示用户下一步可执行 `/kex-dev:test`。
